<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ECharts饼状图</title>
</head>
<body>
<!-- 引入ECharts和JQuery文件 -->
<script src='../js/plugins/echarts/echarts.common.min.js'></script>
<script src="../js/plugins/jquery/jquery.min.js"></script>
<script>
    //将集合中的数据保留两位小数
    function dataToFixed(data) {
        var seriesData = [];
        for (var i = 0; i < data.seriesSaleList.length; i++) {
            //将销量保留两位小数
            var temp = data.seriesSaleList[i].toFixed(2);
            seriesData.push(temp);
        }
        return seriesData;
    }

    //生成图标的方法
    function generateChart(data) {
        //基于准备好的DOM，初始化echarts实例
        var myChart = echarts.init(document.getElementById('main'));
        //指定图表的配置项和数据
        myChart.clear();
        option = {
            title: {
                text: '商家销售柱状图',
                x: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data: [data.xAxisList]
            },
            series: [
                {
                    name: '访问来源',
                    type: 'pie',
                    radius: '55%',
                    center: ['50%', '60%'],
                    data: [
                        {value: dataToFixed(data)},//处理小数点数据, name:'直接访问'
                        // {value: dataToFixed(data)},//, name: '邮件营销'
                        // {value: dataToFixed(data)},//, name: '联盟广告'
                        // {value: dataToFixed(data)},//, name: '视频广告'
                        // {value: dataToFixed(data)} //, name: '搜索引擎'
                    ],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };
        //使用刚指定的配置项和数据显示图表
        myChart.setOption(option);
    }
        //buttion调用的方法
        function getData() {
            var start = $('#start').val();
            var end = $('#end').val();
            var sellerId = $('#sellerId').val();
            //异步请求
            $.post(
                "../ordersale/getData.do",//访问地址
                {start: start, end: end, sellerId: sellerId},//携带的参数
                function (data) {
                    generateChart(data);
                },
                "json"
            );

    }
</script>
<div align="center">
    <label for="start">开始日期：</label><input id="start" type="date" value="2017-08-23"/>
    <label for="end">结束日期：</label><input id="end" type="date" value="2017-08-26"/>
    <label for="sellerId">商家名称：</label><input id="sellerId" type="text"/>
    <button onclick="getData()">查询</button>
</div>
<hr>
<!-- 为ECharts准备一个具备大小（宽高）的DOM容器-->
<div id='main' style='width: 90%;height:400px;' align="center"></div>
</body>
</html>